{"version":3,"sources":["appDispatcher.js","actions/actionTypes.js","api/apiUtils.js","../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","stores/courseStore.js","api/courseApi.js","actions/course/courseActions.js","components/ManageCoursePage.jsx"],"names":["dispatcher","Dispatcher","CREATE_COURSE","LOAD_COURSES","UPDATE_COURSE","DELETE_COURSE","CREATE_AUTHOR","LOAD_AUTHOR","UPDATE_AUTHOR","DELETE_AUTHOR","handleResponse","response","a","ok","json","status","text","error","Error","handleError","console","_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","CHANGE_EVENT","_courses","store","callback","this","on","removeListener","emit","slug","find","course","EventEmitter","register","action","actionType","actionTypes","emitChange","courses","map","id","parseInt","courseId","baseUrl","process","REACT_APP_API_URL","saveCourse","fetch","method","headers","body","JSON","stringify","authorId","then","catch","courseApi","savedCourse","dispatch","toast","info","loadCourses","deleteCourse","CourseForm","loadable","ManageCoursePage","props","useState","errors","setErrors","history","useHistory","courseStore","getCourses","setCourses","title","category","setCourse","onChange","useEffect","addChangeLister","match","params","getCoursesBySlug","removeChangeListener","className","updateCourse","name","onSubmit","event","preventDefault","_error","formIsValid"],"mappings":"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","file":"static/js/7.f1888029.chunk.js","sourcesContent":["import { Dispatcher } from \"flux\"\r\n\r\nconst dispatcher = new Dispatcher()\r\n\r\nexport default dispatcher\r\n","/* eslint-disable import/no-anonymous-default-export */\r\nexport default {\r\n\tCREATE_COURSE: \"CREATE_COURSE\",\r\n\tLOAD_COURSES: \"LOAD_COURSES\",\r\n\tUPDATE_COURSE: \"UPDATE_COURSE\",\r\n\tDELETE_COURSE: \"DELETE_COURSE\",\r\n\tCREATE_AUTHOR: \"CREATE_AUTHOR\",\r\n\tLOAD_AUTHOR: \"LOAD_AUTHOR\",\r\n\tUPDATE_AUTHOR: \"UPDATE_AUTHOR\",\r\n\tDELETE_AUTHOR: \"DELETE_AUTHOR\",\r\n}\r\n","export async function handleResponse(response) {\n  if (response.ok) return response.json();\n  if (response.status === 400) {\n    // So, a server-side validation error occurred.\n    // Server side validation returns a string error message, so parse as text instead of json.\n    const error = await response.text();\n    throw new Error(error);\n  }\n  throw new Error(\"Network response was not ok.\");\n}\n\n// In a real app, would likely call an error logging service.\nexport function handleError(error) {\n  // eslint-disable-next-line no-console\n  console.error(\"API call failed. \" + error);\n  throw error;\n}\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","import { EventEmitter } from \"events\"\r\nimport Dispatcher from \"../appDispatcher\"\r\nimport actionTypes from \"../actions/actionTypes\"\r\n\r\nconst CHANGE_EVENT = \"change\"\r\nlet _courses = []\r\n\r\nclass CoursesStore extends EventEmitter {\r\n\taddChangeLister(callback) {\r\n\t\tthis.on(CHANGE_EVENT, callback)\r\n\t}\r\n\r\n\tremoveChangeListener(callback) {\r\n\t\tthis.removeListener(CHANGE_EVENT, callback)\r\n\t}\r\n\r\n\temitChange() {\r\n\t\tthis.emit(CHANGE_EVENT)\r\n\t}\r\n\r\n\tgetCourses() {\r\n\t\treturn _courses\r\n\t}\r\n\r\n\tgetCoursesBySlug(slug) {\r\n\t\treturn _courses.find(course => course.slug === slug)\r\n\t}\r\n}\r\n\r\nconst store = new CoursesStore()\r\n\r\nDispatcher.register(action => {\r\n\tswitch (action.actionType) {\r\n\t\tcase actionTypes.CREATE_COURSE:\r\n\t\t\t_courses.push(action.course)\r\n\t\t\tstore.emitChange()\r\n\t\t\tbreak\r\n\r\n\t\tcase actionTypes.LOAD_COURSES:\r\n\t\t\t_courses = action.courses\r\n\t\t\tstore.emitChange()\r\n\t\t\tbreak\r\n\r\n\t\tcase actionTypes.UPDATE_COURSE:\r\n\t\t\t_courses = _courses.map(course => (course.id === action.course.id ? action.course : course))\r\n\t\t\tstore.emitChange()\r\n\t\t\tbreak\r\n\r\n\t\tcase actionTypes.DELETE_COURSE:\r\n\t\t\t_courses = _courses.filter(course => course.id !== parseInt(action.courseId, 10))\r\n\t\t\tstore.emitChange()\r\n\t\t\tbreak\r\n\r\n\t\tdefault:\r\n\t}\r\n})\r\n\r\nexport default store\r\n","import { handleResponse, handleError } from \"./apiUtils\"\nconst baseUrl = process.env.REACT_APP_API_URL\n\t? process.env.REACT_APP_API_URL + \"/courses/\"\n\t: \"https://my-json-server.typicode.com/rayhansoe/course-db-json/courses/\"\n\nexport function getCourses() {\n\treturn fetch(baseUrl).then(handleResponse).catch(handleError)\n}\n\nexport function getCourseBySlug(slug) {\n\treturn fetch(baseUrl + \"?slug=\" + slug)\n\t\t.then(response => {\n\t\t\tif (!response.ok) throw new Error(\"Network response was not ok.\")\n\t\t\treturn response.json().then(courses => {\n\t\t\t\tif (courses.length !== 1) throw new Error(\"Course not found: \" + slug)\n\t\t\t\treturn courses[0] // should only find one course for a given slug, so return it.\n\t\t\t})\n\t\t})\n\t\t.catch(handleError)\n}\n\nexport function saveCourse(course) {\n\treturn fetch(baseUrl + (course.id || \"\"), {\n\t\tmethod: course.id ? \"PUT\" : \"POST\", // POST for create, PUT to update when id already exists.\n\t\theaders: { \"content-type\": \"application/json\" },\n\t\tbody: JSON.stringify({\n\t\t\t...course,\n\t\t\t// Parse authorId to a number (in case it was sent as a string).\n\t\t\tauthorId: parseInt(course.authorId, 10),\n\t\t}),\n\t})\n\t\t.then(handleResponse)\n\t\t.catch(handleError)\n}\n\nexport function deleteCourse(courseId) {\n\treturn fetch(baseUrl + courseId, { method: \"DELETE\" })\n\t\t.then(handleResponse)\n\t\t.catch(handleError)\n}\n","import * as courseApi from \"../../api/courseApi\"\r\nimport dispatcher from \"../../appDispatcher\"\r\nimport actionTypes from \"../actionTypes\"\r\nimport { toast } from \"react-toastify\"\r\n\r\nexport const saveCourse = course => {\r\n\treturn courseApi.saveCourse(course).then(savedCourse => {\r\n\t\tdispatcher.dispatch({\r\n\t\t\tactionType: course.id ? actionTypes.UPDATE_COURSE : actionTypes.CREATE_COURSE,\r\n\t\t\tcourse: savedCourse,\r\n\t\t})\r\n\t\tcourse.id ? toast.info(\"🚀 Course Updated\") : toast.info(\"🚀 Course Saved\")\r\n\t})\r\n}\r\n\r\nexport const loadCourses = async () => {\r\n\treturn await courseApi.getCourses().then(courses => {\r\n\t\tdispatcher.dispatch({\r\n\t\t\tactionType: actionTypes.LOAD_COURSES,\r\n\t\t\tcourses,\r\n\t\t})\r\n\t})\r\n}\r\n\r\nexport const deleteCourse = courseId => {\r\n\treturn courseApi.deleteCourse(courseId).then(() => {\r\n\t\tdispatcher.dispatch({\r\n\t\t\tactionType: actionTypes.DELETE_COURSE,\r\n\t\t\tcourseId,\r\n\t\t})\r\n\t\ttoast.error(\"⚠ Course deleted\")\r\n\t})\r\n}\r\n","import React, { useState, useEffect } from \"react\"\r\nimport loadable from \"@loadable/component\"\r\nimport courseStore from \"../stores/courseStore\"\r\nimport { saveCourse, loadCourses } from \"../actions/course/courseActions\"\r\nimport { useHistory } from \"react-router-dom\"\r\nconst CourseForm = loadable(() => import(\"./CourseForm\"))\r\n\r\nconst ManageCoursePage = props => {\r\n\tconst [errors, setErrors] = useState({})\r\n\tlet history = useHistory()\r\n\tconst [courses, setCourses] = useState(courseStore.getCourses())\r\n\tconst [course, setCourse] = useState({\r\n\t\tid: null,\r\n\t\tslug: \"\",\r\n\t\ttitle: \"\",\r\n\t\tauthorId: null,\r\n\t\tcategory: \"\",\r\n\t})\r\n\r\n\tuseEffect(() => {\r\n\t\tcourseStore.addChangeLister(onChange)\r\n\t\tconst slug = props.match.params.slug\r\n\r\n\t\tif (courses.length === 0) {\r\n\t\t\tloadCourses()\r\n\t\t} else if (slug) {\r\n\t\t\tif (courseStore.getCoursesBySlug(slug)) {\r\n\t\t\t\tsetCourse(courseStore.getCoursesBySlug(slug))\r\n\t\t\t} else {\r\n\t\t\t\thistory.push(\"/404\")\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn () => courseStore.removeChangeListener(onChange)\r\n\t}, [courses.length, history, props.match.params.slug])\r\n\tfunction onChange() {\r\n\t\tsetCourses(courseStore.getCourses())\r\n\t}\r\n\r\n\tconst formIsValid = () => {\r\n\t\tconst _error = {}\r\n\r\n\t\tif (!course.title) _error.title = \"Title is required\"\r\n\t\tif (!course.authorId) _error.authorId = \"Author is required\"\r\n\t\tif (!course.category) _error.category = \"Category is required\"\r\n\r\n\t\tsetErrors(_error)\r\n\t\t// Form is valid if the errors object has no props.\r\n\t\treturn Object.keys(_error).length === 0\r\n\t}\r\n\r\n\tconst handleChange = ({ target }) => {\r\n\t\tconst updateCourse = { ...course, [target.name]: target.value }\r\n\t\tsetCourse(updateCourse)\r\n\t}\r\n\r\n\tconst handleSubmit = event => {\r\n\t\tevent.preventDefault()\r\n\t\tif (!formIsValid()) return\r\n\t\tsaveCourse(course).then(() => {\r\n\t\t\tprops.history.push(\"/courses\")\r\n\t\t})\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className='jumbotron'>\r\n\t\t\t\t<h2>Manage Course</h2>\r\n\t\t\t\t{props.match.params.slug ? <h5 className='mt-3 fw-normal'>{course.title}</h5> : \"\"}\r\n\t\t\t</div>\r\n\r\n\t\t\t<CourseForm course={course} onChange={handleChange} onSubmit={handleSubmit} errors={errors} />\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default ManageCoursePage\r\n"],"sourceRoot":""}